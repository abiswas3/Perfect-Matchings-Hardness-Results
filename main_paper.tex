\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry} % Adjust margins as needed
\input{base_template}
\usepackage{accents}
\usepackage{calc}

\input{theorem}
\input{paper_commands.tex} %These are generic commands (Might move them to %base template)is
\newcommand{\Degree}[1]{\mathsf{Deg}\left(#1\right)}
\newcommand{\PerfectMatching}[1]{\mathsf{PM}\left(#1\right)}


% \newcommand{\PC}{\underset{\texttt{PC}_F}{\vdash}}
\newcommand{\PC}{\vdash_{\texttt{PC}_F}}
\newcommand{\SOS}{\vdash_{\texttt{SOS}}}
\newcommand{\en}{\textcolor{ballblue}{n}}
\newcommand{\dee}{\textcolor{cadmiumgreen}{d}}
\newcommand{\eigen}{\textcolor{red}{\lambda}}
\newcommand{\EnDeeLambda}{(n, d, \lambda)}
\newcommand{\Subdivision}[2]{{#1}^{#2}}
\newcommand{\MinimalDegree}[1]{\delta(#1)}
%\newcommand{\Indicator}[1]{\mathbbm{1}\left\{#1\right\}}
\newcommand{\dbtilde}[1]{\tilde{\raisebox{0pt}[0.85\height]{$\tilde{#1}$}}}

\newcommand{\epsilonA}{\textcolor{ballblue}{\epsilon_a}}
\newcommand{\epsilonL}{\textcolor{cadmiumgreen}{\epsilon_\lambda}}
\newcommand{\na}{\textcolor{razzmatazz}{n_A}}

\newcommand{\EdgesAccross}[2]{e_{#2}(#1)}
\newcommand{\BipartiteG}{G_{A \cup A}}

\newcommand{\DistSet}[1]{\Delta(#1)}
\newcommand{\Dist}{\mathcal{D}}
\newcommand{\EdgesShort}{E}
%\newcommand{\Mean}[2]{\underset{#1}{\mathbb{E}}\left[#2\right]}
\newcommand{\Mean}[2]{\mathbb{E}_{#1}\left[#2\right]}
\newcommand{\Prob}[1]{\Pr\left[#1 \right]}
\newcommand{\PProb}[2]{\Pr_{#2}\left[#1 \right]}
\newcommand{\ExpansionFactor}[1]{\lambda(#1)}
\synctex=1
% Title
\title{\textcolor{definitioncolor}{Refuting Perfect Matchings In Expander Graphs Is Also Hard}}
\newcommand{\dApproxLower}{\textcolor{red}{d'}}
\newcommand{\dApproxExpandedLower}{\textcolor{black}{2\epsilon d}}
\newcommand{\dApproxExpandedUpper}{\textcolor{black}{\epsilon d + \sqrt{\nicefrac{d}{2}\log (2/\delta)}}}
%\sqrt{\nicefrac{d}{2}\log (2/\delta)} ; this is the error term

% \author{}
\author[1]{Ari Biswas}
\author[2]{Rajko Nenadov}
\affil[1]{\small University Of Warwick, United Kingdom}
\affil[2]{\small University Of Auckland, New Zealand}

% ITCS guidelines.
% Authors should register and submit their paper via the hotcrp submission site, by the above strict deadlines. The font size should be at least 11 point and the paper should be single column. Beyond these, there are no formatting requirements. Authors are required to submit a COI declaration upon submission.
% Authors should strive to make their paper accessible not only to experts in their subarea, but also to the theory community at large. The submission should include clear proofs of all central claims. In addition, it is strongly recommended that the paper contain, within the first 10 pages, a concise and clear presentation of the merits of the paper, including a discussion of its significance, innovations, and place within (or outside) of our field's scope and literature. The committee will put a premium on writing that conveys clearly, in as simple and straightforward a manner as possible, what the paper accomplishes.
\date{}
% \linenumbers
\begin{document}

\maketitle
\begin{abstract}
Todo
\end{abstract}

\section{Introduction}


\begin{theorem}{Main Result}{thm:main-thm}
There is a constant $d_0 \in \Naturals$ such that for all $d \geq d_0$, the following holds asymptotically almost surely for any $(n, d, \lambda)$-graph $G$ on $n$ vertices, where $n$ is odd and $\lambda < ??$:
\begin{enumerate}
    \item{ $\Degree{\PerfectMatching{G} \PC \bot} = \BigOmega{\nicefrac{n}{\log n}}$} 
    \item{$\Degree{\PerfectMatching{G} \SOS \bot} = \BigOmega{\nicefrac{n}{\log n}}$}
    \item \highlight{add in the frege}
\end{enumerate}


\highlight{Figure out what the condition must be on $\lambda$}
\end{theorem}


\section{Technical Overview}

Put in proof by pictures here.



\section{Preliminaries}

\paragraph{Notation} Sets are denoted with upper case normal font e.g., $S$. Families (or collections) of sets are denoted with upper case calligraphic purple text e.g., $\Family{S}$. 


\begin{definition}[Dependency Graphs]
	
\end{definition}

\begin{lemma}[Lov\`asz Local Lemma]\label{lemma:lll}Let $\Dist \in \DistSet{\bit^*}$ be a discrete probability distribution.
Let $E_1,...,E_n$ be a set of events, and assume that the following hold:

\begin{enumerate}
	\item $\PProb{E_i}{\Dist} \leq \delta$ for some $\delta \in (0,1)$.
	\item The degree of the dependency graph given by $E_1, \dots, E_n$ is bounded by $d$
	\item $d\delta \leq \nicefrac{1}{4}$
	
Then, 

\[ \PProb{\overset{n}{ \underset{i=1}{\cap}} \hspace{0.1cm}  \overline{E_i}}{\Dist} > 0\]	
\end{enumerate}
	
\end{lemma}

\subsection{Proof Complexity Preliminaries}

\begin{definition}[Polynomial Calculus Refutations]\label{def:poly-calc-refutations}
	
\end{definition}

\subsection{Graph Theory Preliminaries}

For a graph $\Graph$, we use $\Vertices{\Graph}$ and $\Edges{\Graph}$ to denote the vertices and edges of $\Graph$. 
For any $E' \subseteq \Edges{\Graph}$ and a vertex $v \in \Vertices{\Graph}$, we use $\Neighbourhood{E'}{v} = \{ u \in \Vertices{\Graph} : (u,v) \in E' \}$ to denote the neighbourhood of $v$ with respect to $E'$, and $\degree{E'}{v}$ to denote the number of vertices adjacent to $v$ via edges in $E'$.

\begin{definition}[Subgraph]\label{def:subgraph}
A graph $G'=(V', E')$ is a subgraph of another graph $G=(V, E)$ iff (1) $V'\subseteq V$, and (2) $E'\subseteq E$ and  $(v1, v2) \in E' \implies (v1, v2) \in V')$.
	
\end{definition}

\begin{definition}[Sub-divisions]\label{def:subdivisions}
Given a graph $H$ and a function $\sigma: \Edges{H} \rightarrow \Naturals$, the $\sigma$-subdivision $H$, denoted by $\Subdivision{H}{\sigma}$, is the graph obtained by replacing each edge in $\Edges{H}$ with a path of length $\sigma(e)$ joining the end points of $e$ (such that all these paths are mutually vertex disjoint, except at the end points).	
\end{definition}

\begin{definition}[Topological Minor]\label{def:topological-minor}
A graph $H$ is a topological minor of a graph $G$ if there exists a subdivision $\Subdivision{H}{\sigma}$ that is isomorphic to \emph{any} subgraph of $G$.	
\end{definition}

Next we define pseudorandom graphs or expander graphs. 
Throughout this document, it suffices to treat $d$ as a small constant.

\begin{definition}[$\EnDeeLambda$ pseudorandom graphs]\label{def:expander-graphs}
Let $G$ be a $d$-regular graph on $n$ vertices, and, let $\lambda_1 \geq \lambda_2, \dots, \geq \lambda_n$ denote eigenvalues of the adjacency matrix of $G$.
We say $G$ is an $\EnDeeLambda$-graph if $\ExpansionFactor{\Graph} \Def \underset{{\{2, \dots, n\}}}{\max}|\lambda_i| \leq \lambda$.
\end{definition}


\begin{lemma}[Expander Mixing Lemma]\label{lemma:expanders-mixing-lemma}
	
\end{lemma}


\section{Embedding Machinery}

The following definitions are adapted from \citep{nenadov2023routing} but were originally introduced by \citet{feldman1988wide} in their work about the theory of wide sense blocking networks.

\begin{definition}[$(p, q)$-non blocking bipartite graphs \citep{nenadov2023routing}]
Given $p,q \in \Naturals$ , we say that a bipartite graph $\Graph = (A \cup B, E)$ is $(p, q)$ \emph{non-blocking}, if there exists a family $\Family{S}$ of subsets of $E$, called the \emph{safe states}, such that the following holds:

\begin{enumerate}
	\item $\emptyset \in \Family{S}$
	\item If $E'' \subseteq E'$ and $E' \in \Family{S}$, \emph{then}, $E'' \in \Family{S}$.
	\item Given $E' \in \Family{S}$ such that $|E'| \leq p$, and \emph{any} $v \in A$ with $\degree{E'}{v} < q$, there exists $e = (v, w) \in E \setminus E'$  such that (i) $E' \cup \Set{e} \in \SafeStates $, and (ii) $w$ is not incident to any edge in $E'$ i.e. $\forall x \in A$ we have $(x,w) \notin E'$. 
\end{enumerate}

\end{definition}


\paragraph{Why are non-blocking graphs useful} \highlight{Use the get out of jail analysis I wrote down.}\par
\begin{figure}[h]
\center
%\floatbox[{\capbeside\thisfloatsetup{capbesideposition={right,top},capbesidewidth=4cm}}]{figure}[\FBwidth]
{\caption{A test figure with its caption side by side}\label{fig:test}}
{\includegraphics{assets/non-blocking-networks.pdf}}
\end{figure}

Next, we re-state a lemma by \citep[Proposition 1]{feldman1988wide} which describes the properties bipartite graphs must satisfy to be non-blocking.

\begin{lemma}\label{lemma:condtions-for-non-block}
Fix $a, r, s \in \Naturals$. Let $\Graph = (A \cup B, E)$ be a bipartite graph.
If for every $X \subseteq A$ of size $1 \leq |X| \leq 2a$, there are \emph{at least} $(r + s)|X|$ vertices in $B$ that are adjacent to $A$, \emph{then}, $\Graph$ is $(r, as)$-non blocking.
\end{lemma}


\section{Proof Of Main Result}

Let $G=(V,E)$ denote any $\EnDeeLambda$-graph on an odd number of vertices, and,  $\HardInstance$ denote the hard instance on $t$ vertices, as described by \citet{buss1999linear}, where the refutal certificate is of degree $\BigOmega{t}$.


\begin{enumerate}
	\item First, we show (via Lemma \ref{lemma:partition}) that we can partition the vertices of the graph $\Graph$ into two disjoint sets $A$ and $B$, as shown in Figure \ref{subfig:partitionA}. The partition has the property that for each vertex $v \in V$, has roughly $\epsilon d$ neighbours inside $A$ i.e. $|\Neighbourhood{E}{v} \cap A| \approx \epsilon d$, where $\epsilon$ is a small enough constant. Given this partitioning, we define consider the subgraph $G_A = (A, E_A)$ where the we only include edges with both endpoints in $A$ (see Figure \ref{subfig:partitionB}).
	\item Secondly, we find a subdivision $\Subdivision{H}{\sigma}$ of $H$, where for each $e \in \Edges{H}$, we have $\sigma(e) = \PathSize$ for some $l = \lceil 1/2\log_{D}n\rceil$ and $\PathSize$ is an odd integer (can be expressed as $\PathSize = 2k+1$ for some $k \in \Naturals$. We show (via Lemma \ref{lemma:top-embedding}) that $\Subdivision{H}{\sigma}$ is a subgraph of $G_A$ defined above.
	
%	\item Successfully executing the above steps guarantees that $\HardInstance$ exists inside of $\Graph$ as a topological minor. But as described earlier, this does not suffice in showing that $\PerfectMatching{\Graph}$ is also hard to refute. Let $\Embedding{\HardInstance}$ denote the vertices that form the topological embedding of $\HardInstance$ in $\Graph$. We want to show that the induced subgraph $\Graph[\Vertices{\Graph} \setminus \Embedding{\HardInstance}]$ contains a perfect matching. 
	\item We show (via Lemma \ref{lemma:perfect-matching}) that the subgraph of $G$ not participating in the topological embedding above, has a perfect matching $M$. For all $e \in M$, we set $x_e = 1$ and for all $e \notin \Edges{\Embedding{\Subdivision{H}{\sigma}}}$ but not in $M$, set $x_e = 0$. These assignments imply that the formula for refuting $\PerfectMatching{G}$ can be partially filled up, and we are left with the task of refuting a restricted formula. Refuting this restricted formula is identical to finding a refutation in the original hard instance, and thus the proof complexity for refuting perfect matching for $G$ is $\BigOmega{t}$ where $t$ is the number of vertices in the hard instance $H$. We show that $t = \BigOmega{n\log n}$.
\end{enumerate}

\subsection{Step 1: Partition $G$ into $A$ and $B$}



%\begin{figure*}[t!]
%    \centering
%    \begin{subfigure}[t]{0.5\textwidth}
%        \centering
%        \includegraphics{assets/ParitionA.pdf}
%        \caption{The figure above describes the partitioning of the vertices of the graph $G$ into two sets $A$ and $B$, such that for every vertex $v \in \Vertices{G}$, $\epsilon d$ fraction of the edges go into $A$ (depicted in orange) and $1 - \epsilon d$ fraction of the edges go into $B$.}
%    \end{subfigure}%
%    ~ 
%    \begin{subfigure}[t]{0.5\textwidth}
%        \centering
%        \includegraphics{assets/PartitionB.pdf}
%        \caption{The figures on top describes the subgraph $G_A$ obtained by including vertices in $A$, and only edges that stay inside $A$ (orange edges). The figure below describes how we construct a bipartite graph $\BipartiteG$ from $G_A$.}
%    \end{subfigure}
%%    \caption{Caption place holder}
%\end{figure*}

\begin{figure*}[t!]
    \centering
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \includegraphics[scale=0.7]{assets/ParitionA.pdf}
        \caption{The figure above describes the partitioning of the vertices of the graph $G$ into two sets $A$ (highlighted in green) and $B$ (highlighted in blue), such that for every vertex $v \in \Vertices{G}$, $\epsilon d$ fraction of the edges go into $A$ (depicted in orange) and $1 - \epsilon d$ fraction of the edges go into $B$.}
        \label{subfig:partitionA}
    \end{subfigure}%
    \hspace{1mm}
    \vrule width 1pt % vertical line
    \hspace{1mm}
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \includegraphics[scale=0.7]{assets/PartitionB.pdf}
        \caption{The figures on top describes the subgraph $G_A$ obtained by including vertices in $A$ and edges that stay inside $A$ (orange edges), as described in the construction of Step 2. The figure below describes the bipartite graph $\BipartiteG$ we use for the embedding theorem.}
        \label{subfig:partitionB}        
    \end{subfigure}
\end{figure*}


%Figure \ref{fig:partition} pictorially describes Lemma \ref{lemma:partition}.

\begin{lemma}\label{lemma:partition}Given a $\EnDeeLambda$ graph $\Graph = (V, E)$, there exists a small constant $\epsilon \in (0,1)$ and a partition of $V$ into disjoint sets $A$ and $B$, such that, we have for every $v \in V$, $|\Neighbourhood{\EdgesShort}{v} \cap A| \leq 2\epsilon d$.
%where $\delta \in (0,1)$ such that $\delta d \leq 1/4$.	
\end{lemma}

\begin{proof}We prove the existence of such a partition $A \cup B = V$ using the probabilistic method.
For each $v \in \Vertices{\Graph}$, we toss an independent coin $X_i$ with bias $\epsilon$.
If $X_i = 1$, then we include $v$ in $A$, else we put $v$ in $B$.
Thus, $\vec{X} \Def (X_1, \dots, X_n) \in \bit^n$ is a random variable that describes how we partition $\Vertices{G}$ into sets $A$ and $B$.
For any $v \in V$, let $Y_v = |\Neighbourhood{\EdgesShort}{v} \cap A| = \sum_{e \in \Neighbourhood{E}{v}} \Indicator{e \in A}$ denote the random variable that counts how many neighbours of $a$ are also in $A$.\\
For any $v \in V$, let $E_v = \Indicator{|Y_v - d\epsilon | \geq \sqrt{d/2\log 2/\delta}}$ denote the bad event that $Y_v$ is very far from $\epsilon d$.
As $\Graph$ is $d$-regular, $\Mean{\vec{X}}{Y_v} = \epsilon d$, and that the dependency graph of events $\{ E_v \}_{v \in V}$ has max-degree at most $d$.
By Chernoff-Hoeffding, for any $v \in V$, we have $\PProb{E_v}{\vec{X}} \leq \delta$.
Finally, by setting $\delta$ small enough, such that $\delta d \leq 1/4$, we can invoke the Lov\`asz Local Lemma (Lemma \ref{lemma:lll}) to get $\PProb{\forall v \in V, \text{ } E_v = 0}{\vec{X}} > 0$.
When $E_v = 0$ for all $v \in V$, setting $\epsilon = \sqrt{2 \log(2/\delta)}$, gives us that $|Y_v - d\epsilon | \leq \sqrt{d/2}\sqrt{\log 2/\delta}	 \leq \epsilon d$.

\end{proof}

%Let $\tilde{\Graph} = A \cup B$ be the bipartite graph defined in the construction of Lemma \ref{lemma: bipartite-construct-non-block}.
%We know that this graph $(\pee, \qu)$ is non-blocking.
%Let $(a_1, \dots, a_k)$ denote an arbitrary ordering of arbitrary vertices in $A$.
%Set $E' = \emptyset$. 
%As $\tilde{\Graph}$ is non-blocking, there exists a collection of \emph{safe states} $\SafeStates$.


\subsection{Step 2: The Topological Emebedding}

Let $G=(V,E)$, be the $\EnDeeLambda$ graph given to us. 
Let $\epsilon, A$ and $B$ be as defined by Lemma \ref{lemma:partition}. 
Define $\dApproxLower \Def \dApproxExpandedLower$.
Define $E_A \Def \{ (u,v) \in E : u \in A \land v \in A\}$. 
That is $E_A$ are the edges whose endpoints are fully contained in A (orange edges in Figure \ref{subfig:partitionA}), and $G_A = (A, E_A)$. 
Define $ \na = |A|$.
Now define a bipartite graph $\BipartiteG = (V_A \cup V_A)$ such that if $(u,v) \in E_A$, then $(u,v) \in \Edges{\BipartiteG}$.
As $G$ is an $\EnDeeLambda$ graph, we have that $\BipartiteG$ is a $(\na, \dApproxLower, \lambda)$ graph.

\begin{lemma}\label{lemma:bipartitie-is-non-blocking}Let $G$ be the $\EnDeeLambda$ graph given to us and let $\BipartiteG$ be the bipartite graph described above. 
%Let $\epsilon$ be the small constant from Lemma \ref{lemma:partition}.
%Define $\dApproxLower = \dApproxExpandedLower$.
There exists $\epsilonL, \epsilonA  \in (0,1)$ small enough, such that if $\lambda < \epsilonL \dApproxLower$, then $\BipartiteG$ is $(\frac{\dApproxLower}{\lambda}, \epsilonA\na)$ non-blocking.
\end{lemma}

\begin{proof}
Let $X$ and $Y$ denote the left and right vertices of the bipartite graph $\BipartiteG$.
Define $a = \epsilonA\cdot\frac{\lambda \na}{\dApproxLower}$.
Fix $S \subseteq X$ such that $1 \leq |S| \leq 2a$.
Suppose towards a contradiction, $G_A$ is \emph{not} non-blocking.
Then by Lemma \ref{lemma:condtions-for-non-block}, for all $T \subseteq Y$, $\EdgesAccross{S, T}{E_A} \leq (2\dApproxLower/\lambda)|S|$.
Pick $T^* \subseteq Y$ such that 

\begin{equation}
\EdgesAccross{S, T^*}{E_A} \geq |S|\dApproxLower	 \label{eq:lots-edges}
\end{equation}

We know $T^*$ exists as $G_A$ is $\dApproxLower$ regular.
From the expander mixing lemma \ref{lemma:expanders-mixing-lemma},

\begin{align}
	\EdgesAccross{S, T^*}{E_A} &\leq \frac{\dApproxLower}{\na}|S||T^*| + \lambda\sqrt{|S||T^*|} \\
	&\leq \frac{\dApproxLower^2}{\na \lambda}|S|^2 + |S|\sqrt{2\lambda \dApproxLower} \label{eq:stepa}\\
	&< \frac{\dApproxLower^2}{\na \lambda}|S|^2 + |S|\dApproxLower\sqrt{2\epsilonL } \label{eq:stepb}\\
	&\leq |S|\dApproxLower\left[ \frac{\dApproxLower|S|}{\na\lambda} + \sqrt{2\epsilonL}\right] \\
	&\leq |S|\dApproxLower\left[ \frac{\epsilonA}{2} + \sqrt{2\epsilonL}\right] \label{eq:stepc}
\end{align}


For Equation \eqref{eq:stepa} We use that $\EdgesAccross{S, T^*}{E_A} \leq (2\dApproxLower/\lambda)|S|$. For Equation \eqref{eq:stepb} we use $\lambda < \epsilonL\dApproxLower$. For Equation \eqref{eq:stepc} we use $|S| \leq 2a$.
Setting $\epsilonA$ and $\epsilonL$ small enough such that  $\frac{\epsilonA}{2} + \sqrt{2\epsilonL} < 1$, we get a contradiction with Equation \eqref{eq:lots-edges}.

\end{proof}

The next step is to topologically embed hard instance $H$ into the subgraph $G_A = (A, E_A)$.
Note for every edge in $G_A$, by our construction, we will have a corresponding edge in the bipartite graph $\BipartiteG$.

\begin{lemma}[Topological Embedding]\label{lemma:top-embedding}
Let $\epsilonA, \epsilonL \in (0,1)$ be the constants from Lemma \ref{lemma:bipartitie-is-non-blocking}.
Let $H$ be the worst case hard instance on $t = \lceil\epsilonA \frac{\na}{\log \na}\rceil$ vertices. 
\end{lemma}

\begin{proof}
Define $D = \frac{\dApproxLower}{\lambda}$.
Denote $\Vertices{H} = \{ h_1, \dots, h_t\}$.
For each $h \in \Vertices{H}$, our first task is to find a unique $\Embedding{h} \in \Vertices{G_A}$.
Let $\{a_1, \dots, a_{t}\}$ be arbitrary set of $t$ vertices in $\Vertices{G_A}$.
We repeat the following process to obtain $\{ \Embedding{h_1}, \dots, \Embedding{h_t}\}$.
Let $X=\Vertices{G_A}$ and $Y=\Vertices{G_A}$ denote the left and right sides of $\BipartiteG$.


\begin{figure}
	\center
	\includegraphics[width=0.9\textwidth]{assets/baseCaseA.pdf }
	\caption{The figure above describes }
	\label{fig:baseA}
\end{figure}	


\begin{itemize}
	\item Set $E' = \emptyset$ to begin with.
	\item For $a_1 \in X$, ask for $D$ neighbours in $Y$. As $|E'| \leq \epsilonA \na$, and $\BipartiteG$ is $(D, \epsilonA \na)$ non-blocking, we can find $\tilde{h}_1 \in Y$ such that there is no edge in $|E'|$ is incident on $\tilde{h}_1$. We set $\Embedding{a_1} = \tilde{h}_1$ and $E' = E'  \cup \{(a_1, \tilde{h}_1)\}$.
	\item We repeat this process for all $a \in \{a_2, \dots, a_t\}$. As $|E'| \leq t < \epsilonA\na$, for each $a_j$ we can always find a $\tilde{h}_j$ in $Y$ such that there is an edge $(a_j, \tilde{h}_j)$, and there is no edge in $E'$ that is incident on each $\tilde{h}_j$.
\end{itemize}

The next step to show that for each $(u,v) \in \Edges{H}$, there is a vertex disjoint path of odd length $\PathSize = 2k+1 \log_{D}(\na)$ between $\Embedding{u}$ and $\Embedding{v}$ in $G_A$.
Let $(e_1, \dots, e_m)$ be an arbitrary ordering of edges in $\Edges{H}$.
We prove the result by induction on $m$.

\subsubsection{Base Case, $m=1$}

\paragraph{Forward Phase} 

Define a set $E'= \emptyset$. 
Let $e_1 = (u,v)$. Define a set $S_0 = \{\Embedding{u}\}$ and $\tilde{S}_0 = \{ \Embedding{v}\}$.
Define sets $M_{u}$ and $\tilde{M}_{v}$ to be sets of $s_z = \min\{t, s_{z-1}D\}$ edges in $E_A$ incident to $S_{z-1}$ and $\tilde{S}_{z-1}$ respectively, such that each vertex in $S_{z-1} \subseteq Y$ and $\tilde{S}_{z-1} \subseteq Y$ is incident to \emph{at most one} edge in $E' \cup M_u \cup \tilde{M}_v$.
We know such sets exist as $\BipartiteG$ is $(D, \epsilonA \na)$ non-blocking, and by repeatedly applying property 3 of non-blocking graphs, we can always such sets.\\

More concretely, we start with $\Embedding{u} \in X$ and ask for $D$ edges in $E_A$. 
As $|E'| = 0 < \na \epsilonA$, by the non-blocking property 3, we can always find least one neighbour $w$ in $Y$ such that there is no edge in $E'$ already incident on $w$ (any neighbour suffices).
$M_u$ consists of $s_1 = \min\{t, |S_0|D\}$ such edges connecting $\Embedding{u}$ to such neighbours.
$S_1$ is the collection of $s_1$ neighbours. 
Now, we repeat the process with $\Embedding{v}$, by asking for $D$ neighbours in $Y$, such that there is no edge in $E' \cup M_u$ that is incident on these neighbours.
We form $\tilde{M}_v$
(\highlight{See Figure)}.
Now for each $x \in S_1$, we ask for $D$ neighbours again such that there is no edge in 


$M_1$ represents the edges connecting $\Embedding{u}$ to at most $s_1$ many such neighbours, and $S_1$ is the set of these neighbours.
We repeat the same process by asking for $D$ neighbours of $\Embedding{v}$, and construct $\tilde{M}_1$ and $\tilde{S}_1$.
For each $(y, \Embedding{v} in \tilde{M}_1$, we require that there is no edge in $E' \cup M_1$ already incident on $y$.
Now for each $x \in S_1$, we once again ask for $D$ neighbours in $Y$, and construct $M_2$ with at most $s_2$ edges $(x,y)$ such that $y$ is incident on no edge in $E' \cup M_1 \cup \tilde{M}_1$.
As $k = \BigO{\log n}$, we can always construct sets $M_1, \dots, M_k$ and $\tilde{M_1}, \dots, \tilde{M}_k$.
Now, the expander mixing lemma (Lemma \ref{lemma:expanders-mixing-lemma}) says that there any two nodes $\Embedding{u}$ and $\Embedding{v}$ are connected by a path of size $\PathSize = 2k+1$.
This implies that there must be an edge $e=(a,b)$ between $S_k$ and $\tilde{S}_k$ (depicted in green in Figure \ref{fig:baseA}).

\paragraph{Base Case, Backwards Phase}

We add $e$ to $E'$, and consider end point $a \in S_k$.
By how we constructed $M_k$, we know there is an edge $m_k = (a,c)$ connecting $a$ to some vertex $c$ in $M_{k-1}$, such that $a$ has no other edges incident on it. We repeat this process all the way, till we get $k+1$ edges, $m_1 m_2 \dots, m_k e$.
We add all these edges to $E'$.
We repeat the same process for the other end point of $b \in S_k'$, to get edges $\tilde{m}_1, \dots, \tilde{m}_k$.
We add these edges to $E'$ as well. 
This gives is the situation depicted in Figure \ref{fig:baseB}.
Thus, we have found an odd length path of length $2k+1=\log_D \na$, connecting $\Embedding{u}$ to $\Embedding{v}$.

\begin{figure}
	\includegraphics[width=0.9\textwidth
	]{assets/BaseCaseB.pdf}
	\caption{Base B}
	\label{fig:baseB}
\end{figure}



\paragraph{Induction Step}
	
Assume that we have found paths for $e_1, \dots, e_j$ for $j < m$.
The situation is described in Figure \ref{fig:induction}.
The set $E'$ consists of $j$ paths of size $\PathSize$. Therefore $|E'| \leq m*$	
	
\begin{figure}
	\center
	\includegraphics[width=0.9\textwidth]{assets/InductionStep.pdf}
	\caption{Induction}
	\label{fig:induction}
\end{figure}	

	
\end{proof}

\subsection{Step 3: Finding A Perfect Matching In The Remainder Of The Graph}

%Lemma \ref{lemma:expanders-minimal-matching} is from \citep[Theorem 4.3]{krivelevich2006pseudo}, that says the pseudorandom graphs on an even number of vertices have perfect matchings.

\begin{lemma}\label{lemma:expanders-minimal-matching}\citep[Theorem 4.3]{krivelevich2006pseudo}
Let $\Graph$ be an $\EnDeeLambda$ graph with $\lambda \leq d - 2$	and $n$ is even. Then $\Graph$ has a perfect matching.
\end{lemma}

\begin{lemma}\label{lemma:perfect-matching}
Given $\EnDeeLambda$ graph $\Graph=(V,E)$, let $\Embedding{\Subdivision{H}{\sigma}}$ be the topological embedding of the hard instance $H$ from Lemma \ref{lemma:top-embedding}.
If $\lambda \leq \nicefrac{d}{C}$ for some large enough constant $C > 0$, then the sub-graph $\Graph[V \setminus \Embedding{\Subdivision{H}{\sigma}}]$ has a perfect matching.	
\end{lemma}

\begin{proof}
\ari{Change notation}
Let $\epsilon, \delta, A$ and $B$ be as defined in Lemma \ref{lemma:partition}.
Define $\tilde{d} = 1 - (2\epsilon d)$
Let $\Embedding{\Subdivision{H}{\sigma}}$ denote the subgraph of $G$ which represents the topological embedding of $H$ from Lemma \ref{lemma:top-embedding}.
Define $\tilde{G} = \Graph[V \setminus \Embedding{\Subdivision{H}{\sigma}}]$. 
That is $\tilde{\Graph}$ is a subgraph of $\Graph$ using all vertices in $B$ and the vertices in $A$ that were not used to embed $\Subdivision{H}{\sigma}$.
As $\ExpansionFactor{\Graph} \leq \lambda$, and $\tilde{\Graph}$ is a subgraph, we have $\ExpansionFactor{\tilde{\Graph}} \leq \lambda$.
%\ari{This is super easy to show using basic linear algebra, I can explicitly prove this if you think it's needed.}
By lemma \ref{lemma:partition}, we know that the minimal degree $\MinimalDegree{\tilde{\Graph}} \geq \tilde{d}$.
Let $\dbtilde{\Graph}$ denote a subgraph of $\tilde{G}$, where for each $v \in \Vertices{\tilde{\Graph}}$ we retain exactly $\tilde{d}$ of its neighbours.
It is easy to see that $\dbtilde{\Graph}$ is a $(\tilde{n}, \tilde{d}, \lambda)$ pseudorandom graph, where $\tilde{n} = |\Vertices{\tilde{\Graph}}|$ and $n$ is even (since $|\Vertices{\Graph}|$ is odd and $|\Vertices{\Embedding{\Subdivision{H}{\sigma}}}|$ is also odd). 
As $\lambda \leq \tilde{d} - 2$, we invoke Lemma \ref{lemma:expanders-minimal-matching} to get that $\dbtilde{G}$ has a perfect matching.
As $\dbtilde{G}$ is a sub-graph of $\tilde{G}$ with the same vertex set, $\tilde{G}$ also has a perfect matching.
\ari{Set $C$ here so that this is less complex}.
\end{proof}

\section{Related Work}

\clearpage
\bibliographystyle{abbrvnat}
\bibliography{main_paper}
\end{document}
